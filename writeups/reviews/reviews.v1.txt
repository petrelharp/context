> Reviewer: 1
> Comments to the Author
> In their article "Enabling inference for context-dependent models of
> mutation by bounding the propagation of dependency" Matsen and Ralph
> discuss methodology to infer mutation rates in context dependent
> models of DNA evolution. With the advent of more sequence data it
> became clear that the first very simple models of DNA evolution are
> only a crude approximation to the "real" process. The extension of
> such models to also include neighbor dependencies is very timely.
> However, the inclusion of such processes is easier said than done -
> without "bounding the propagation of dependency" such models are
> computational not tractable.

> The paper is very well written and gives sufficient detail.

> The source code of the mentioned R package is available at github.com
> .


> Reviewer: 2
> Comments to the Author
> In this manuscript the authors address the problem how to infer model
> parameters and model "ingredients" (allowed transitions) in models of
> sequence evolution, in which the rate of mutations depends on the
> local sequence context of a site. This is a significant problem and
> surprisingly difficult. The authors present a solution where they
> decompose the full transition matrix into elements that map
> subsequences into even shorter subsequences. This is an approximation,
> but they give a bound on the approximation and even more importantly
> show that the method works on two sets of simulated data. They then
> apply the method to real sequence data from humans and chimpanzee and
> find interesting rates for different processes relevant for sequence
> evolution.

> This is overall a very nice work, which in addition is presented very
> lucidly, but there are a few points the authors should address before
> publication:

> 1) Could the authors provide some thoughts about sequences with
> periodic boundary conditions. That would be a natural setup both for
> the TASEP that they use as one of their examples and for bacterial
> genomes. Would they expect the method to still work and/or does
> anything need to be changed?

> 2) Since the authors in the introduction bring up contexts like wild
> fires, land use patterns, and cell-cell interactions, could the
> authors in the discussion at least speculate about the possibility of
> extending this approach to 2D or 3D systems?

> 3) There are a few places where the presentation could be improved:

> a) It is somewhat confusing that in the definition of the x --i,u,v-->
> y relation toward the end of section 1 the indices i of the sequences
> x and y are one-based while the indices k of the patterns u and v are
> zero-based. Can this be made more consistent?

TODO This seems nice to have as an offset, but perhaps we could make it
more obvious?

> b) It is quite confusing that the length of the sequence is n in
> section 1 and then switches to L in section 2. Later n becomes the
> length of a subsequence block. The notation should ideally be made
> consistent between the sections, or, at a minimum, the reader should
> be warned of these notation changes.

TODO It does seem like we could change the n in section 1.3 to an L.

> c) This referee would take some objection to calling the simulation
> algorithm in section 2 a Gillespie algorithm. The whole point of the
> Gillespie algorithm is to advance time in such a way that every step
> of the algorithm results in a transition. This is not the case in the
> algorithm the authors present since they always step forward with the
> maximal possible rate but then allow non-transitions.



> d) There is an inconsistency between equations (5), (6), and the
> equation right below (6). In the numerator the identification between
> the symbols must be that (n,l,r) in (5) is (2l+1,l+1,l) in (6).
> However, the upper index on x is n in (5) but 4l+1 != 2l+1 in (6).
> That is true in the denominator as well. Also,
> m=n-l-r=(2l+1)-(l+1)-l=0 != 2l+1 (if the authors meant that n was
> actually 4l+1, 4l+1-(l+1)-l=2l != 2l+1 does not work much better
> either) and in the denominator it is not clear why m should change
> given that l and r just get swapped and m only depends on their sum.
> Maybe this referee totally misunderstands the notation here, but this
> fact alone means that something needs to be improved in the
> presentation in this area.

TODO: Sorry about this. I suggest the solution is to change the
first subscript on p to 4l+1.

> d) It is somewhat counterintuitive that the caption of figure 4 talks
> of "bases". This seems like taking the analogy a bit too far.
> Shouldn't it be "spins"?

TODO: seems good to me

> e) Remove a "that" in "that that" in the fifth line of appendix C.

Fixed, thanks.
